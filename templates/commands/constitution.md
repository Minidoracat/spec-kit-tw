---
description: 從互動式或提供的原則輸入建立或更新專案章程，確保所有依賴的模板保持同步。
---

使用者輸入可以直接由代理提供或作為命令參數提供給您 - 在繼續執行提示之前，您**必須**考慮它（如果不為空）。

使用者輸入：

$ARGUMENTS

您正在更新 `/memory/constitution.md` 處的專案章程。此檔案是一個包含方括號中佔位符標記（例如 `[PROJECT_NAME]`、`[PRINCIPLE_1_NAME]`）的模板。您的工作是（a）收集/推導具體值，（b）精確填寫模板，（c）在任何依賴的工件中傳播任何修改。

遵循此執行流程：

1. 載入 `/memory/constitution.md` 處的現有章程模板。
   - 識別每個 `[ALL_CAPS_IDENTIFIER]` 形式的佔位符標記。
   **重要**：使用者可能需要比模板中使用的更多或更少的原則。如果指定了數字，請遵守 - 遵循通用模板。您將相應地更新文件。

2. 收集/推導佔位符的值：
   - 如果使用者輸入（對話）提供了值，則使用它。
   - 否則從現有倉儲上下文（README、文件、嵌入的先前章程版本）推導。
   - 對於治理日期：`RATIFICATION_DATE` 是原始採用日期（如果未知則詢問或標記 TODO），`LAST_AMENDED_DATE` 是今天如果進行了更改，否則保持先前值。
   - `CONSTITUTION_VERSION` 必須根據語義化版本控制規則遞增：
     * MAJOR：向後不相容的治理/原則刪除或重新定義。
     * MINOR：新原則/部分新增或實質性擴展指導。
     * PATCH：澄清、措辭、非語義改進。
   - 如果版本遞增類型不明確，請在最終確定之前提出推理。

3. 起草更新的章程內容：
   - 用具體文字替換每個佔位符（除非專案選擇不定義，否則不留下括號標記——明確說明任何留下的內容）。
   - 保留標題層次結構，一旦替換可以刪除註釋，除非它們仍然提供澄清指導。
   - 確保每個原則部分：簡潔的標題行，段落（或項目符號列表）捕獲不可協商的規則，如果明顯則提供明確的基本原理。
   - 確保治理部分列出修改程序、版本控制策略和合規性審查期望。

4. 一致性傳播檢查清單（將先前檢查清單轉換為活動驗證）：
   - 閱讀 `/templates/plan-template.md` 並確保任何「章程檢查」或規則與更新的原則對齊。
   - 閱讀 `/templates/spec-template.md` 以進行範圍/要求對齊——如果章程新增/刪除強制性部分或約束則更新。
   - 閱讀 `/templates/tasks-template.md` 並確保任務分類反映新的或刪除的原則驅動的任務類型（例如，可觀察性、版本控制、測試紀律）。
   - 閱讀 `/templates/commands/*.md` 中的每個命令檔案（包括此檔案）以驗證沒有過時的參考（當需要通用指導時，像 CLAUDE 這樣的代理特定名稱仍然存在）。
   - 閱讀任何執行時指導文件（例如，`README.md`、`docs/quickstart.md` 或存在的代理特定指導檔案）。更新對更改的原則的參考。

5. 生成同步影響報告（在章程檔案更新後作為 HTML 註釋前置到頂部）：
   - 版本更改：舊 → 新
   - 修改的原則列表（如果重命名則為舊標題 → 新標題）
   - 新增的部分
   - 刪除的部分
   - 需要更新的模板（✅ 已更新 / ⚠ 待處理）以及檔案路徑
   - 如果有任何佔位符被有意延遲，則為後續 TODO。

6. 最終輸出前的驗證：
   - 沒有剩餘的未解釋括號標記。
   - 版本行與報告匹配。
   - 日期 ISO 格式 YYYY-MM-DD。
   - 原則是聲明性的、可測試的，並且沒有模糊語言（「should」 → 在適當時替換為 MUST/SHOULD 基本原理）。

7. 將完成的章程寫回 `/memory/constitution.md`（覆蓋）。

8. 向使用者輸出最終摘要，包含：
   - 新版本和遞增基本原理。
   - 標記為手動後續操作的任何檔案。
   - 建議的提交訊息（例如，`docs: amend constitution to vX.Y.Z (principle additions + governance update)`）。

格式和樣式要求：
- 準確使用 Markdown 標題，如模板中所示（不要降級/提升級別）。
- 換行長行以保持可讀性（理想情況下 <100 字元），但不要用尷尬的換行符強制執行。
- 在部分之間保留單個空行。
- 避免尾隨空格。

如果使用者提供部分更新（例如，只有一個原則修訂），仍然執行驗證和版本決策步驟。

如果缺少關鍵資訊（例如，批准日期確實未知），則插入 `TODO(<FIELD_NAME>): explanation` 並將其包含在同步影響報告中的延遲項下。

不要建立新模板；始終操作現有的 `/memory/constitution.md` 檔案。